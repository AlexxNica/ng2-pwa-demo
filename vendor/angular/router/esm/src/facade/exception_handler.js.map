{"version":3,"file":"exception_handler.js","sourceRoot":"","sources":["../../../../../../modules/@angular/router/src/facade/exception_handler.ts"],"names":[],"mappings":"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","sourcesContent":["import {isPresent, isBlank} from './lang';\nimport {BaseWrappedException} from './base_wrapped_exception';\nimport {isListLikeIterable} from './collection';\n\nclass _ArrayLogger {\n  res: any[] = [];\n/**\n * @param {?} s\n * @return {?}\n */\nlog(s: any): void { this.res.push(s); }\n/**\n * @param {?} s\n * @return {?}\n */\nlogError(s: any): void { this.res.push(s); }\n/**\n * @param {?} s\n * @return {?}\n */\nlogGroup(s: any): void { this.res.push(s); }\n/**\n * @return {?}\n */\nlogGroupEnd(){};\n\n  static _tsickle_typeAnnotationsHelper() {\n /** @type {?} */\n_ArrayLogger.prototype.res;\n  }\n\n}\n\n/**\n * Provides a hook for centralized exception handling.\n *\n * The default implementation of `ExceptionHandler` prints error messages to the `Console`. To\n * intercept error handling,\n * write a custom exception handler that replaces this default as appropriate for your app.\n *\n * ### Example\n *\n * ```javascript\n *\n * class MyExceptionHandler implements ExceptionHandler {\n *   call(error, stackTrace = null, reason = null) {\n *     // do something with the exception\n *   }\n * }\n *\n * bootstrap(MyApp, [provide(ExceptionHandler, {useClass: MyExceptionHandler})])\n *\n * ```\n */\nexport class ExceptionHandler {\n/**\n * @param {?} _logger\n * @param {?=} _rethrowException\n */\nconstructor(private _logger: any,\nprivate _rethrowException: boolean = true) {}\n/**\n * @param {?} exception\n * @param {?=} stackTrace\n * @param {?=} reason\n * @return {?}\n */\nstatic exceptionToString(exception: any, stackTrace: any = null, reason: string = null): string {\n    var /** @type {?} */ l = new _ArrayLogger();\n    var /** @type {?} */ e = new ExceptionHandler(l, false);\n    e.call(exception, stackTrace, reason);\n    return l.res.join(\"\\n\");\n  }\n/**\n * @param {?} exception\n * @param {?=} stackTrace\n * @param {?=} reason\n * @return {?}\n */\ncall(exception: any, stackTrace: any = null, reason: string = null): void {\n    var /** @type {?} */ originalException = this._findOriginalException(exception);\n    var /** @type {?} */ originalStack = this._findOriginalStack(exception);\n    var /** @type {?} */ context = this._findContext(exception);\n\n    this._logger.logGroup(`EXCEPTION: ${this._extractMessage(exception)}`);\n\n    if (isPresent(stackTrace) && isBlank(originalStack)) {\n      this._logger.logError(\"STACKTRACE:\");\n      this._logger.logError(this._longStackTrace(stackTrace));\n    }\n\n    if (isPresent(reason)) {\n      this._logger.logError(`REASON: ${reason}`);\n    }\n\n    if (isPresent(originalException)) {\n      this._logger.logError(`ORIGINAL EXCEPTION: ${this._extractMessage(originalException)}`);\n    }\n\n    if (isPresent(originalStack)) {\n      this._logger.logError(\"ORIGINAL STACKTRACE:\");\n      this._logger.logError(this._longStackTrace(originalStack));\n    }\n\n    if (isPresent(context)) {\n      this._logger.logError(\"ERROR CONTEXT:\");\n      this._logger.logError(context);\n    }\n\n    this._logger.logGroupEnd();\n\n    // We rethrow exceptions, so operations like 'bootstrap' will result in an error\n    // when an exception happens. If we do not rethrow, bootstrap will always succeed.\n    if (this._rethrowException) throw exception;\n  }\n/**\n * @internal\n * @param {?} exception\n * @return {?}\n */\n_extractMessage(exception: any): string {\n    return exception instanceof BaseWrappedException ? exception.wrapperMessage :\n                                                       exception.toString();\n  }\n/**\n * @internal\n * @param {?} stackTrace\n * @return {?}\n */\n_longStackTrace(stackTrace: any): any {\n    return isListLikeIterable(stackTrace) ? ( /** @type {?} */((<any[]>stackTrace))).join(\"\\n\\n-----async gap-----\\n\") :\n                                            stackTrace.toString();\n  }\n/**\n * @internal\n * @param {?} exception\n * @return {?}\n */\n_findContext(exception: any): any {\n    try {\n      if (!(exception instanceof BaseWrappedException)) return null;\n      return isPresent(exception.context) ? exception.context :\n                                            this._findContext(exception.originalException);\n    } catch ( /** @type {?} */e) {\n      // exception.context can throw an exception. if it happens, we ignore the context.\n      return null;\n    }\n  }\n/**\n * @internal\n * @param {?} exception\n * @return {?}\n */\n_findOriginalException(exception: any): any {\n    if (!(exception instanceof BaseWrappedException)) return null;\n\n    var /** @type {?} */ e = exception.originalException;\n    while (e instanceof BaseWrappedException && isPresent(e.originalException)) {\n      e = e.originalException;\n    }\n\n    return e;\n  }\n/**\n * @internal\n * @param {?} exception\n * @return {?}\n */\n_findOriginalStack(exception: any): any {\n    if (!(exception instanceof BaseWrappedException)) return null;\n\n    var /** @type {?} */ e = exception;\n    var /** @type {?} */ stack = exception.originalStack;\n    while (e instanceof BaseWrappedException && isPresent(e.originalException)) {\n      e = e.originalException;\n      if (e instanceof BaseWrappedException && isPresent(e.originalException)) {\n        stack = e.originalStack;\n      }\n    }\n\n    return stack;\n  }\n\n  static _tsickle_typeAnnotationsHelper() {\n /** @type {?} */\nExceptionHandler.prototype._logger;\n /** @type {?} */\nExceptionHandler.prototype._rethrowException;\n  }\n\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}