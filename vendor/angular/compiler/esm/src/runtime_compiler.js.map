{"version":3,"file":"runtime_compiler.js","sourceRoot":"","sources":["../../../../../modules/@angular/compiler/src/runtime_compiler.ts"],"names":[],"mappings":"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","sourcesContent":["import {Injectable, ComponentFactory, ComponentResolver} from '@angular/core';\n\nimport {\n  IS_DART,\n  Type,\n  isBlank,\n  isString\n} from '../src/facade/lang';\nimport {BaseException} from '../src/facade/exceptions';\nimport {\n  ListWrapper,\n} from '../src/facade/collection';\nimport {PromiseWrapper} from '../src/facade/async';\nimport {\n  createHostComponentMeta,\n  CompileDirectiveMetadata,\n  CompilePipeMetadata,\n  CompileIdentifierMetadata\n} from './compile_metadata';\nimport {\n  TemplateAst,\n} from './template_ast';\nimport {StyleCompiler, StylesCompileDependency, StylesCompileResult} from './style_compiler';\nimport {ViewCompiler} from './view_compiler/view_compiler';\nimport {TemplateParser} from './template_parser';\nimport {DirectiveNormalizer} from './directive_normalizer';\nimport {CompileMetadataResolver} from './metadata_resolver';\nimport {CompilerConfig} from './config';\nimport * as ir from './output/output_ast';\nimport {jitStatements} from './output/output_jit';\nimport {interpretStatements} from './output/output_interpreter';\nimport {InterpretiveAppViewInstanceFactory} from './output/interpretive_view';\nimport {XHR} from './xhr';\nexport class RuntimeCompiler implements ComponentResolver {\nprivate _styleCache: Map<string, Promise<string>> = new Map<string, Promise<string>>();\nprivate _hostCacheKeys = new Map<Type, any>();\nprivate _compiledTemplateCache = new Map<any, CompiledTemplate>();\nprivate _compiledTemplateDone = new Map<any, Promise<CompiledTemplate>>();\n/**\n * @param {?} _metadataResolver\n * @param {?} _templateNormalizer\n * @param {?} _templateParser\n * @param {?} _styleCompiler\n * @param {?} _viewCompiler\n * @param {?} _xhr\n * @param {?} _genConfig\n */\nconstructor(private _metadataResolver: CompileMetadataResolver,\nprivate _templateNormalizer: DirectiveNormalizer,\nprivate _templateParser: TemplateParser,\nprivate _styleCompiler: StyleCompiler,\nprivate _viewCompiler: ViewCompiler,\nprivate _xhr: XHR,\nprivate _genConfig: CompilerConfig) {}\n/**\n * @param {?} component\n * @return {?}\n */\nresolveComponent(component: Type|string): Promise<ComponentFactory<any>> {\n    if (isString(component)) {\n      return PromiseWrapper.reject(new BaseException(`Cannot resolve component using '${component}'.`), null);\n    }\n\n    let /** @type {?} */ componentType = /** @type {?} */(( <Type>component));\n    var /** @type {?} */ compMeta: CompileDirectiveMetadata =\n        this._metadataResolver.getDirectiveMetadata(componentType);\n    var /** @type {?} */ hostCacheKey = this._hostCacheKeys.get(componentType);\n    if (isBlank(hostCacheKey)) {\n      hostCacheKey = new Object();\n      this._hostCacheKeys.set(componentType, hostCacheKey);\n      assertComponent(compMeta);\n      var /** @type {?} */ hostMeta: CompileDirectiveMetadata =\n          createHostComponentMeta(compMeta.type, compMeta.selector);\n\n      this._loadAndCompileComponent(hostCacheKey, hostMeta, [compMeta], [], []);\n    }\n    return this._compiledTemplateDone.get(hostCacheKey)\n        .then((compiledTemplate: CompiledTemplate) => new ComponentFactory(\n                  compMeta.selector, compiledTemplate.viewFactory, componentType));\n  }\n/**\n * @return {?}\n */\nclearCache() {\n    this._styleCache.clear();\n    this._compiledTemplateCache.clear();\n    this._compiledTemplateDone.clear();\n    this._hostCacheKeys.clear();\n  }\n/**\n * @param {?} cacheKey\n * @param {?} compMeta\n * @param {?} viewDirectives\n * @param {?} pipes\n * @param {?} compilingComponentsPath\n * @return {?}\n */\nprivate _loadAndCompileComponent(cacheKey: any, compMeta: CompileDirectiveMetadata,\n                                   viewDirectives: CompileDirectiveMetadata[],\n                                   pipes: CompilePipeMetadata[],\n                                   compilingComponentsPath: any[]): CompiledTemplate {\n    var /** @type {?} */ compiledTemplate = this._compiledTemplateCache.get(cacheKey);\n    var /** @type {?} */ done = this._compiledTemplateDone.get(cacheKey);\n    if (isBlank(compiledTemplate)) {\n      compiledTemplate = new CompiledTemplate();\n      this._compiledTemplateCache.set(cacheKey, compiledTemplate);\n      done =\n          PromiseWrapper.all(\n                            [ /** @type {?} */((<any>this._compileComponentStyles(compMeta)))].concat(viewDirectives.map(\n                                dirMeta => this._templateNormalizer.normalizeDirective(dirMeta))))\n              .then((stylesAndNormalizedViewDirMetas: any[]) => {\n                var /** @type {?} */ normalizedViewDirMetas = stylesAndNormalizedViewDirMetas.slice(1);\n                var /** @type {?} */ styles = stylesAndNormalizedViewDirMetas[0];\n                var /** @type {?} */ parsedTemplate =\n                    this._templateParser.parse(compMeta, compMeta.template.template,\n                                               normalizedViewDirMetas, pipes, compMeta.type.name);\n\n                var /** @type {?} */ childPromises = [];\n                compiledTemplate.init(this._compileComponent(compMeta, parsedTemplate, styles,\n                                                             pipes, compilingComponentsPath,\n                                                             childPromises));\n                return PromiseWrapper.all(childPromises).then((_) => { return compiledTemplate; });\n              });\n      this._compiledTemplateDone.set(cacheKey, done);\n    }\n    return compiledTemplate;\n  }\n/**\n * @param {?} compMeta\n * @param {?} parsedTemplate\n * @param {?} styles\n * @param {?} pipes\n * @param {?} compilingComponentsPath\n * @param {?} childPromises\n * @return {?}\n */\nprivate _compileComponent(compMeta: CompileDirectiveMetadata, parsedTemplate: TemplateAst[],\n                            styles: string[], pipes: CompilePipeMetadata[],\n                            compilingComponentsPath: any[],\n                            childPromises: Promise<any>[]): Function {\n    var /** @type {?} */ compileResult = this._viewCompiler.compileComponent(\n        compMeta, parsedTemplate,\n        new ir.ExternalExpr(new CompileIdentifierMetadata({runtime: styles})), pipes);\n    compileResult.dependencies.forEach((dep) => {\n      var /** @type {?} */ childCompilingComponentsPath = ListWrapper.clone(compilingComponentsPath);\n\n      var /** @type {?} */ childCacheKey = dep.comp.type.runtime;\n      var /** @type {?} */ childViewDirectives: CompileDirectiveMetadata[] =\n          this._metadataResolver.getViewDirectivesMetadata(dep.comp.type.runtime);\n      var /** @type {?} */ childViewPipes: CompilePipeMetadata[] =\n          this._metadataResolver.getViewPipesMetadata(dep.comp.type.runtime);\n      var /** @type {?} */ childIsRecursive = ListWrapper.contains(childCompilingComponentsPath, childCacheKey);\n      childCompilingComponentsPath.push(childCacheKey);\n\n      var /** @type {?} */ childComp =\n          this._loadAndCompileComponent(dep.comp.type.runtime, dep.comp, childViewDirectives,\n                                        childViewPipes, childCompilingComponentsPath);\n      dep.factoryPlaceholder.runtime = childComp.proxyViewFactory;\n      dep.factoryPlaceholder.name = `viewFactory_${dep.comp.type.name}`;\n      if (!childIsRecursive) {\n        // Only wait for a child if it is not a cycle\n        childPromises.push(this._compiledTemplateDone.get(childCacheKey));\n      }\n    });\n    var /** @type {?} */ factory;\n    if (IS_DART || !this._genConfig.useJit) {\n      factory = interpretStatements(compileResult.statements, compileResult.viewFactoryVar,\n                                    new InterpretiveAppViewInstanceFactory());\n    } else {\n      factory = jitStatements(`${compMeta.type.name}.template.js`, compileResult.statements,\n                              compileResult.viewFactoryVar);\n    }\n    return factory;\n  }\n/**\n * @param {?} compMeta\n * @return {?}\n */\nprivate _compileComponentStyles(compMeta: CompileDirectiveMetadata): Promise<string[]> {\n    var /** @type {?} */ compileResult = this._styleCompiler.compileComponent(compMeta);\n    return this._resolveStylesCompileResult(compMeta.type.name, compileResult);\n  }\n/**\n * @param {?} sourceUrl\n * @param {?} result\n * @return {?}\n */\nprivate _resolveStylesCompileResult(sourceUrl: string,\n                                      result: StylesCompileResult): Promise<string[]> {\n    var /** @type {?} */ promises = result.dependencies.map((dep) => this._loadStylesheetDep(dep));\n    return PromiseWrapper.all(promises)\n        .then((cssTexts) => {\n          var /** @type {?} */ nestedCompileResultPromises = [];\n          for (var /** @type {?} */ i = 0; i < result.dependencies.length; i++) {\n            var /** @type {?} */ dep = result.dependencies[i];\n            var /** @type {?} */ cssText = cssTexts[i];\n            var /** @type {?} */ nestedCompileResult =\n                this._styleCompiler.compileStylesheet(dep.moduleUrl, cssText, dep.isShimmed);\n            nestedCompileResultPromises.push(\n                this._resolveStylesCompileResult(dep.moduleUrl, nestedCompileResult));\n          }\n          return PromiseWrapper.all(nestedCompileResultPromises);\n        })\n        .then((nestedStylesArr) => {\n          for (var /** @type {?} */ i = 0; i < result.dependencies.length; i++) {\n            var /** @type {?} */ dep = result.dependencies[i];\n            dep.valuePlaceholder.runtime = nestedStylesArr[i];\n            dep.valuePlaceholder.name = `importedStyles${i}`;\n          }\n          if (IS_DART || !this._genConfig.useJit) {\n            return interpretStatements(result.statements, result.stylesVar,\n                                       new InterpretiveAppViewInstanceFactory());\n          } else {\n            return jitStatements(`${sourceUrl}.css.js`, result.statements, result.stylesVar);\n          }\n        });\n  }\n/**\n * @param {?} dep\n * @return {?}\n */\nprivate _loadStylesheetDep(dep: StylesCompileDependency): Promise<string> {\n    var /** @type {?} */ cacheKey = `${dep.moduleUrl}${dep.isShimmed ? '.shim' : ''}`;\n    var /** @type {?} */ cssTextPromise = this._styleCache.get(cacheKey);\n    if (isBlank(cssTextPromise)) {\n      cssTextPromise = this._xhr.get(dep.moduleUrl);\n      this._styleCache.set(cacheKey, cssTextPromise);\n    }\n    return cssTextPromise;\n  }\n\n  static _tsickle_typeAnnotationsHelper() {\n /** @type {?} */\nRuntimeCompiler.prototype._styleCache;\n /** @type {?} */\nRuntimeCompiler.prototype._hostCacheKeys;\n /** @type {?} */\nRuntimeCompiler.prototype._compiledTemplateCache;\n /** @type {?} */\nRuntimeCompiler.prototype._compiledTemplateDone;\n /** @type {?} */\nRuntimeCompiler.prototype._metadataResolver;\n /** @type {?} */\nRuntimeCompiler.prototype._templateNormalizer;\n /** @type {?} */\nRuntimeCompiler.prototype._templateParser;\n /** @type {?} */\nRuntimeCompiler.prototype._styleCompiler;\n /** @type {?} */\nRuntimeCompiler.prototype._viewCompiler;\n /** @type {?} */\nRuntimeCompiler.prototype._xhr;\n /** @type {?} */\nRuntimeCompiler.prototype._genConfig;\n  }\n\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\n/** @nocollapse */ static ctorParameters: {type: Function, decorators?: DecoratorInvocation[]}[] = [\n{type: CompileMetadataResolver, },\n{type: DirectiveNormalizer, },\n{type: TemplateParser, },\n{type: StyleCompiler, },\n{type: ViewCompiler, },\n{type: XHR, },\n{type: CompilerConfig, },\n];\n}\n\nclass CompiledTemplate {\n  viewFactory: Function = null;\n  proxyViewFactory: Function;\n/**\n */\nconstructor() {\n    this.proxyViewFactory = (viewUtils, childInjector, contextEl) =>\n        this.viewFactory(viewUtils, childInjector, contextEl);\n  }\n/**\n * @param {?} viewFactory\n * @return {?}\n */\ninit(viewFactory: Function) { this.viewFactory = viewFactory; }\n\n  static _tsickle_typeAnnotationsHelper() {\n /** @type {?} */\nCompiledTemplate.prototype.viewFactory;\n /** @type {?} */\nCompiledTemplate.prototype.proxyViewFactory;\n  }\n\n}\n/**\n * @param {?} meta\n * @return {?}\n */\nfunction assertComponent(meta: CompileDirectiveMetadata) {\n  if (!meta.isComponent) {\n    throw new BaseException(`Could not compile '${meta.type.name}' because it is not a component.`);\n  }\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}